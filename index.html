<script>
// Typing effect
function typeText(element, text, speed=50, callback) {
  let i = 0;
  element.innerHTML = "";
  function type() {
    if (i < text.length) {
      element.innerHTML += text[i];
      i++;
      setTimeout(type, speed);
    } else {
      if (callback) callback();
    }
  }
  type();
}

// Slide elements
const slides = document.querySelectorAll(".slide");
let currentSlide = 0;

// Auto type first slide & then move to next
typeText(document.getElementById("typeText1"), "Started my journey in Mumbaiâ€¦", 60, () => {
  setTimeout(() => nextSlide(), 1500);
});

// Also type second slide text ahead of time (but hidden)
typeText(document.getElementById("typeText2"), "Traveling around the worldâ€¦", 60);

// Slide changer
function nextSlide() {
  slides[currentSlide].classList.remove("active");
  currentSlide++;
  if (currentSlide >= slides.length) {
    currentSlide = slides.length - 1;
  }
  slides[currentSlide].classList.add("active");

  // If arriving at slide 2, show travel text
  if (currentSlide === 1) {
    document.getElementById("subtitle2").innerHTML = "Exploring places âœˆï¸ and dreaming of meeting her ðŸ°";
  }
}

// Accept / Decline buttons logic
document.addEventListener("click", () => {
  if (currentSlide === 1) {
    nextSlide();
  }
});

// Decline button flying
const declineBtn = document.getElementById("declineBtn");
const excuses = [
  "I forgot my heart in Paris âœ¨",
  "The stars arenâ€™t aligned ðŸŒ™",
  "Too many meetings â˜•",
  "My cat disagrees ðŸ˜¼",
  "I need more coffee â˜•",
  "Iâ€™m late for my wings ðŸª½"
];
if (declineBtn) {
  declineBtn.addEventListener("mouseenter", () => {
    const x = Math.random() * (window.innerWidth - 150);
    const y = Math.random() * (window.innerHeight - 150);
    declineBtn.style.transform = `translate(${x}px,${y}px) rotate(${Math.random() * 30 - 15}deg)`;
    document.querySelector(".slide:nth-child(4) .subtitle").innerHTML =
      excuses[Math.floor(Math.random() * excuses.length)];
  });
}

// Instant accept button
const acceptBtn = document.getElementById("acceptBtn");
if (acceptBtn) {
  acceptBtn.addEventListener("click", () => {
    nextSlide();
  });
}

// Animate airplane along path
const plane = document.getElementById("plane");
const pathEl = document.querySelector(".path");
if (plane && pathEl) {
  const length = pathEl.getTotalLength();
  let progress = 0;
  function animatePlane() {
    if (currentSlide < 3) {
      progress += 0.002;
      if (progress > 1) progress = 1;
      const point = pathEl.getPointAtLength(length * progress);
      plane.style.left = point.x + "px";
      plane.style.top = point.y + "px";
    }
    requestAnimationFrame(animatePlane);
  }
  animatePlane();
}
</script>
